<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<?xml-stylesheet href="chrome://zotero/skin/preferences.css" type="text/css"?>

<!DOCTYPE window>

<window
    id="tts-playback-dialog"
    title="TTS Playback - Zotero Summary Creator"
    xmlns="http://www.mozilla.org/keymaster/xul"
    xmlns:html="http://www.w3.org/1999/xhtml"
    width="600"
    height="400"
    style="padding: 0;">

  <script src="chrome://zotero/content/include.js"/>
  <script src="tts-dialog.js"/>

  <html:div style="padding: 20px; font-family: -apple-system, system-ui, sans-serif;">
    <!-- Header -->
    <html:div style="margin-bottom: 20px;">
      <html:h2 id="tts-current-title" style="margin: 0; font-size: 18px; font-weight: 600; color: #333;">
        Loading...
      </html:h2>
      <html:div id="tts-current-authors" style="color: #666; font-size: 13px; margin-top: 4px;">
        Loading paper information...
      </html:div>
    </html:div>

    <!-- Progress Bar -->
    <html:div style="margin-bottom: 20px;">
      <html:progress id="tts-progress" value="0" max="100" style="width: 100%; height: 8px;"></html:progress>
      <html:div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 11px; color: #999;">
        <html:span id="tts-current-position">0%</html:span>
        <html:span id="tts-content-length">0 characters</html:span>
      </html:div>
    </html:div>

    <!-- Playback Controls -->
    <html:div style="display: flex; justify-content: center; gap: 12px; margin-bottom: 24px;">
      <html:button
          id="tts-btn-play"
          onclick="TTSDialog.play();"
          style="padding: 12px 28px; font-size: 15px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
        ▶ Play
      </html:button>
      <html:button
          id="tts-btn-pause"
          onclick="TTSDialog.pause();"
          disabled="true"
          style="padding: 12px 28px; font-size: 15px; background: #FF9800; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; opacity: 0.5;">
        ⏸ Pause
      </html:button>
      <html:button
          id="tts-btn-resume"
          onclick="TTSDialog.resume();"
          disabled="true"
          style="padding: 12px 28px; font-size: 15px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; opacity: 0.5; display: none;">
        ▶ Resume
      </html:button>
      <html:button
          id="tts-btn-stop"
          onclick="TTSDialog.stop();"
          disabled="true"
          style="padding: 12px 28px; font-size: 15px; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; opacity: 0.5;">
        ⏹ Stop
      </html:button>
    </html:div>

    <!-- Speed Control -->
    <html:div style="margin-bottom: 20px;">
      <html:label for="tts-speed" style="display: block; margin-bottom: 8px; font-weight: 600; font-size: 13px; color: #333;">
        Speed: <html:span id="tts-speed-value" style="font-weight: 400; color: #666;">1.0x</html:span>
      </html:label>
      <html:input
          id="tts-speed"
          type="range"
          min="0.5"
          max="2.0"
          step="0.1"
          value="1.0"
          oninput="TTSDialog.updateSpeed(this.value);"
          style="width: 100%; height: 6px;"/>
      <html:div style="display: flex; justify-content: space-between; font-size: 11px; color: #999; margin-top: 4px;">
        <html:span>0.5x</html:span>
        <html:span>1.0x</html:span>
        <html:span>2.0x</html:span>
      </html:div>
    </html:div>

    <!-- Voice Selection -->
    <html:div style="margin-bottom: 20px;">
      <html:label for="tts-voice" style="display: block; margin-bottom: 8px; font-weight: 600; font-size: 13px; color: #333;">
        Voice:
      </html:label>
      <html:select
          id="tts-voice"
          onchange="TTSDialog.changeVoice(this.value);"
          style="width: 100%; padding: 8px; font-size: 13px; border: 1px solid #ddd; border-radius: 4px; background: white;">
        <html:option value="">Loading voices...</html:option>
      </html:select>
    </html:div>

    <!-- Status Message -->
    <html:div
        id="tts-status"
        style="padding: 12px; background: #f5f5f5; border-radius: 4px; font-size: 13px; color: #555; border-left: 4px solid #2196F3;">
      Ready to play
    </html:div>

    <!-- Close Button -->
    <html:div style="margin-top: 24px; text-align: right; padding-top: 16px; border-top: 1px solid #eee;">
      <html:button
          onclick="window.close();"
          style="padding: 10px 24px; font-size: 13px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
        Close
      </html:button>
    </html:div>
  </html:div>
</window>
